# flow-cli - ZSH Workflow Plugin
# ADHD-optimized workflow management for developers

## Status: ACTIVE
## Phase: P7 - Architecture Refactor
## Focus: Pure ZSH plugin with atlas integration

## Current Sprint
- [x] Create ZSH plugin structure
- [x] Create lib/core.zsh (utilities)
- [x] Create lib/atlas-bridge.zsh (atlas integration)
- [x] Create lib/project-detector.zsh
- [x] Create lib/tui.zsh (UI components)
- [x] Create commands/work.zsh
- [x] Create commands/dash.zsh
- [x] Create commands/capture.zsh
- [x] Create commands/adhd.zsh
- [x] Create hooks/chpwd.zsh
- [x] Create hooks/precmd.zsh
- [x] Create flow.plugin.zsh entry point
- [x] Migrate completions (_work, _dash, _finish, _hop, _js)
- [x] Test plugin loading (works with legacy fallback)
- [x] Remove Node.js CLI layer (archived to .archive/)
- [x] Update documentation (CLAUDE.md rewritten for P7)
- [x] Remove legacy duplicates (dash.zsh, work.zsh removed)

## Notes
- New commands/work.zsh and commands/dash.zsh now active
- Legacy adhd-helpers.zsh retained (contains many non-migrated functions)
- Completions use lazy loading + dynamic project discovery

## Next Phase
- [x] Shell integration verified (symlink + .zshrc)
- [x] All key ADHD functions working (hybrid state)
- [x] Hybrid migration complete (new commands/ + legacy zsh/functions/)
- [x] Published as ZSH plugin (v2.0.0)
- [x] Add atlas integration tests (26 tests passing)
- [x] Create GitHub Release with changelog (v2.0.0)
- [x] Add E2E tests for atlas CLI (when installed)
- [x] Document programmatic API in README

## Function Status
New (commands/): work, dash, catch, js, hop, finish
Legacy (working): morning, timer, whatnext, focus, next, why, win, wins, yay, etc.

## Architecture (New)
```
flow-cli/
├── flow.plugin.zsh     # Plugin entry point
├── lib/
│   ├── core.zsh        # Core utilities
│   ├── atlas-bridge.zsh # Atlas integration
│   ├── project-detector.zsh
│   └── tui.zsh         # TUI components
├── commands/
│   ├── work.zsh        # work, finish, hop, why
│   ├── dash.zsh        # dash, dash-tui
│   ├── capture.zsh     # catch, inbox, crumb, win
│   └── adhd.zsh        # js, next, stuck, focus, brk
├── hooks/
│   ├── chpwd.zsh       # Directory change
│   └── precmd.zsh      # Pre-command
├── completions/        # ZSH completions
└── zsh/               # Legacy functions (backward compat)
```

## Integration
- Atlas: Optional state engine (@data-wise/atlas)
- Graceful degradation when atlas not installed
- All commands work standalone

## Installation
```bash
# As ZSH plugin (antidote)
antidote install data-wise/flow-cli

# Manual
source /path/to/flow.plugin.zsh
```
