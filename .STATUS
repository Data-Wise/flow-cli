# flow-cli - Pure ZSH Workflow Plugin
# ADHD-optimized workflow management for developers

## Project: flow-cli
## Type: zsh-plugin
## Status: active
## Phase: v5.10.0 Development
## Priority: 1
## Progress: 10

## Focus: Worktree Detection Fix (Bug Fix)

## ðŸš§ In Progress (2026-01-15):

### Worktree Detection Fix - v5.10.0

**Branch:** `feature/wt-detection`
**Worktree:** `~/.git-worktrees/flow-cli/feature-wt-detection`
**Brainstorm:** `BRAINSTORM-worktree-detection-fix-2026-01-15.md`

**Problem:** `pick wt` fails to detect flat-named worktrees (e.g., `scholar-github-actions`)

**Root Cause:** `_proj_list_worktrees()` only scans level-2 directories, missing flat worktrees at level-1

**Solution:** Hybrid Scanner (Option A)
- Check level-1 dirs for `.git` FILE (flat worktrees)
- Parse `gitdir:` to extract project name
- Fall back to level-2 scan (hierarchical)

**Tasks:**
- [x] Root cause analysis complete
- [x] Deep brainstorm with 8 requirements questions
- [x] Solution design (Hybrid Scanner selected)
- [x] Feature branch created
- [ ] Implement core fix in `_proj_list_worktrees()`
- [ ] Test with `pick wt` and `pick wt scholar`
- [ ] Add cache invalidation to `wt create` (Phase 2)
- [ ] Config file for display names (Phase 3 - future)

**Acceptance Criteria:**
- [ ] `pick wt` shows `scholar-github-actions`
- [ ] All hierarchical worktrees still detected
- [ ] Performance < 100ms

**Next:** Start NEW session in worktree for implementation
```bash
cd ~/.git-worktrees/flow-cli/feature-wt-detection
claude
```

---

## âœ… Completed (2026-01-15):

### Tutorial Enhancement - v5.9.0 Documentation

**Branch:** `feature/tutorial-enhancement`
**Worktree:** `~/.git-worktrees/flow-cli-tutorial-enhancement`

**Completed Tasks:**
- [x] Update Tutorial 14 (teach dispatcher) with v5.9.0 config validation
  - Added Part 3: Config Validation section
  - Documented validation rules, hash-based caching, config ownership
  - Added troubleshooting for validation errors
- [x] Create learning path Mermaid diagram
  - Flowchart showing tutorial progression
  - Color-coded by difficulty (beginner/intermediate/optional)
  - Clickable links to each tutorial
- [x] Add tutorial index with progression overview
  - Created `docs/tutorials/index.md`
  - Quick paths for different user goals
  - All 14 tutorials with time estimates and levels
- [x] Generate VHS tapes for key tutorials
  - `docs/demos/first-session.tape` (Tutorial 1)
  - `docs/demos/dopamine-features.tape` (Tutorial 6)
  - `docs/demos/cc-dispatcher.tape` (Tutorial 10)

**New Files:**
- `docs/tutorials/index.md` - Tutorial index with Mermaid learning path
- `docs/demos/first-session.tape` - VHS demo for Tutorial 1
- `docs/demos/dopamine-features.tape` - VHS demo for Tutorial 6
- `docs/demos/cc-dispatcher.tape` - VHS demo for Tutorial 10

**Updated Files:**
- `docs/tutorials/14-teach-dispatcher.md` - Added v5.9.0 config validation
- `mkdocs.yml` - Added tutorial index to navigation

**Status:** Merged to dev (PR #251, 2026-01-15)

---

## âœ… Just Completed (2026-01-14 - v5.9.0 Released):

### v5.9.0 Scholar Deep Integration - Released âœ…

**Release:** https://github.com/Data-Wise/flow-cli/releases/tag/v5.9.0
**PR:** #249 (merged to main)

**Delivered:**
- [x] JSON Schema for teach-config.yml validation
- [x] Hash-based change detection (SHA-256)
- [x] Config validator with graceful yq fallback
- [x] Flag validation before Scholar invocation
- [x] Enhanced `teach status` with validation summary
- [x] Bug fix: grading sum calculation for mikefarah/yq
- [x] API Reference documentation
- [x] Safe Testing guide with sandbox approach
- [x] Interactive dogfeeding test suite (31/31 passing)

**New Files:**
- `lib/config-validator.zsh` - Validation + hash detection
- `lib/templates/teaching/teach-config.schema.json` - JSON Schema
- `docs/reference/API-REFERENCE.md` - Complete API reference
- `docs/guides/SAFE-TESTING-v5.9.0.md` - Safe testing guide
- `tests/interactive-dogfeed-v5.9.0.zsh` - Interactive test suite

**Release Checklist - All Complete:**
- [x] Implementation complete
- [x] Bug fixes committed
- [x] Dogfeeding tests passing (31/31)
- [x] Interactive testing on real courses
- [x] PR #249: dev â†’ main (merged)
- [x] Tag release: v5.9.0
- [x] Homebrew formula auto-updated
- [x] Documentation deployed to GitHub Pages
- [x] Specs archived to docs/specs/_archive/

---

## âœ… Previously Completed (2026-01-14):

### v5.8.0 Scholar Teaching Wrappers - Bundled in v5.9.0 âœ…

- [x] 9 Scholar wrapper commands via teach dispatcher
- [x] Preflight validation
- [x] Universal flags: `--dry-run`, `--format`, `--output`, `--verbose`
- [x] Tab completion
- [x] 28 tests (all passing)

### v5.7.0 Prompt Engine Dispatcher - Bundled in v5.9.0 âœ…

- [x] New `prompt` dispatcher with 8 subcommands
- [x] Support for Powerlevel10k, Starship, OhMyPosh
- [x] Interactive toggle menu
- [x] 224+ tests

---

## ðŸ“Š Metrics

- **Current Version:** 5.9.0 (Released 2026-01-14)
- **Dispatchers:** 11 active (including prompt)
- **Commands:** 15+ core commands
- **Tests:** 300+ across all features
- **Performance:** Sub-10ms for core commands
- **Documentation:** https://Data-Wise.github.io/flow-cli/

## ðŸ“‹ Future Roadmap

### v5.10.0 (Planned)
- [ ] Installation improvements (curl one-liner)
- [ ] Install script auto-detection of plugin manager
- [ ] Installation docs matching aiterm quality

### Scholar Integration v2.2.0 (After RFC Approval)
- [ ] Scholar team implements `--config` flag
- [ ] Scholar adds JSON Schema validation
- [ ] Bidirectional config sync

### Future Releases
- [ ] Remote state sync (optional cloud backup)
- [ ] Multi-device support
- [ ] Shared templates

## ðŸŽ¯ Next Action

**Current:** Implement worktree detection fix in feature branch

```bash
cd ~/.git-worktrees/flow-cli/feature-wt-detection
claude
```

**After Fix:**
- A) Add cache invalidation to `wt create` [10 min]
- B) Start v5.10.0 installation improvements [2-4 hours]
- C) Create Scholar issue for --config flag RFC [15 min]
